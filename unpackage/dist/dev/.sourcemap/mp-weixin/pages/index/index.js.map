{"version":3,"file":"index.js","sources":["pages/index/index.vue","../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <!-- 遍历所有任务分类 -->\n    <view v-for=\"category in taskCategories\" :key=\"category.id\" class=\"category-wrapper\">\n\n\n      <view class=\"category-card\" @click=\"toggleCategory(category.id)\">\n        <text class=\"category-title\">{{ category.name }}</text>\n        <view class=\"arrow\" :class=\"{ 'is-open': activeCategoryId === category.id }\"></view>\n      </view>\n      \n      <!-- 这是任务列表 (来自旧的 task-list.vue), 只有当分类展开时才显示 -->\n    <view v-if=\"activeCategoryId === category.id\" class=\"task-list-container\">\n        <view v-if=\"!category.tasks || !category.tasks.length\" class=\"task-card empty\">\n          暂无任务\n        </view>\n        <view v-else v-for=\"task in category.tasks\" :key=\"task.id\" class=\"task-card\" @click=\"goToDetail(task, category.value)\">\n          <text class=\"task-title\">{{ task.taskName }}</text>\n        </view>\n      </view>\n\t\t<view v-if=\"activeCategoryId === category.id\" class=\"task-list-container\">\r\n\t\t        <view v-if=\"category.loading\" class=\"task-card empty\">\r\n\t\t          加载中...\r\n\t\t        </view>\r\n\t\t        <view v-else-if=\"category.error\" class=\"task-card empty\">\r\n\t\t          加载失败: {{ category.error }}\r\n\t\t        </view>\r\n\t\t         <view v-else-if=\"!category.tasks || !category.tasks.length\" class=\"task-card empty\">\r\n\t\t          暂无任务\r\n\t\t        </view>\r\n\t\t       <!-- <view v-else v-for=\"task in category.tasks\" :key=\"task.id\" class=\"task-card\" @click=\"goToDetail(task, category.value)\">\r\n\t\t          <text class=\"task-title\">{{ task.taskName }}</text>\r\n\t\t        </view> -->\r\n\t\t      </view>\n    </view>\n  </view>\n  <CustomTabBar current=\"index\" />\n</template>\n\n<script>\nimport CustomTabBar from '@/components/tabBar/tabBar.vue'\nimport { request } from '../../components/request'\n\nexport default {\n  components: {\n    CustomTabBar\n  },\n  data() {\n    return {\n      // 合并后的数据结构\n      taskCategories: [\n        {\n          id: 1,\n          name: '表型采集',\n          value: 'phenotype',\n          tasks: [\n          ],\n          loading: false,\n          error: null\n        },\n        {\n          id: 2,\n          name: '玉米拷种',\n          value: 'roast',\n          tasks: [],\n          loading: false,\n          error: null\n        },\n        {\n          id: 3,\n          name: '其他',\n          value: 'other',\n          tasks: [],\n          loading: false,\n          error: null\n        }\n      ],\n      activeCategoryId: null\n    }\n  },\n  methods: {\n    // 展开/收起分类\n    async toggleCategory(categoryId) {\n      if (this.activeCategoryId === categoryId) {\n        this.activeCategoryId = null\n        return\n      }\n\n      this.activeCategoryId = categoryId\n\n      const category = this.taskCategories.find(c => c.id === categoryId)\n      if (!category) return\n\n      // 如果已有数据或正在加载，则不重复请求\n      if (category.tasks.length > 0 || category.loading) return\n\n      await this.fetchTasks(category)\n    },\n\n    async fetchTasks(category) {\n      category.loading = true\n      category.error = null\n\n      try {\n        const res = await request({\n          url: '/task/getTask',\n          method: 'GET',\n          header: {\n            'Authorization':  uni.getStorageSync('token')||'',\n            'Content-Type': 'application/json'\n          },\n          data: {\n            typeId: category.id\n          }\n        })\n\n        category.tasks = res.data\n      } catch (error) {\n        console.error('获取任务失败:', error)\n        category.error = error.message || '获取任务失败，请稍后重试'\n      } finally {\n        category.loading = false\n      }\n    },\n\n    // 跳转到任务详情页\n    goToDetail(task, typeValue) {\n      uni.navigateTo({\n        url: `/pages/task-detail/task-detail?id=${task.id}&type=${typeValue}`\n      })\n    }\n  }\n}\n</script>\n\n\n<style scoped>\n.container {\n  padding: 50rpx 30rpx 120rpx;\r\n  background: rgba(239, 242, 235, 1);\r\n  height: 100vh;\n}\n\n.category-wrapper {\n  margin-bottom: 30rpx;\n}\n\n.category-card {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  background-color: ghostwhite;\n  border-radius: 16rpx;\n  padding: 40rpx 30rpx;\n  box-shadow: 0 4rpx 10rpx rgba(0, 0, 0, 0.05);\n  position: relative;\n  z-index: 10;\r\n  background: rgba(148, 166, 66, 0.9);\r\n  color: #fff;\n}\n\n.category-title {\n  font-size: 48rpx;\n  font-weight: bold;\n}\n\n\n.arrow {\n  border: solid #555;\n  border-width: 0 4rpx 4rpx 0;\n  display: inline-block;\n  padding: 8rpx;\n  transform: rotate(45deg);\n  transition: transform 0.3s ease;\n}\n\n.arrow.is-open {\n  transform: rotate(-135deg);\n}\n\n.task-list-container {\n  margin-top: -15rpx;\n  padding-top: 25rpx; \n  background-color: #ffffff;\n  border-radius: 0 0 16rpx 16rpx;\n  box-shadow: 0 8rpx 12rpx rgba(0, 0, 0, 0.01);\n  animation: slideDown 0.3s ease-out; \n}\n\n.task-card {\n  background: #fff;\n  padding: 30rpx;\n  border-radius: 12rpx;\r\n  border-bottom:black;\n  text-align: center ;\n}\n\n.task-title {\n  font-size: 30rpx;\n  font-weight: 500;\n  color: #333;\n}\n\n\n.task-card.empty {\n  color: #999;\n  border: 1rpx dashed #ddd;\n}\n\n\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    transform: translateY(-20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n</style>","import MiniProgramPage from 'D:/狮山云瞳/狮山云瞳/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["request","uni"],"mappings":";;;AAwCA,qBAAqB,MAAW;AAGhC,MAAK,YAAU;AAAA,EACb,YAAY;AAAA,IACV;AAAA,EACD;AAAA,EACD,OAAO;AACL,WAAO;AAAA;AAAA,MAEL,gBAAgB;AAAA,QACd;AAAA,UACE,IAAI;AAAA,UACJ,MAAM;AAAA,UACN,OAAO;AAAA,UACP,OAAO,CACN;AAAA,UACD,SAAS;AAAA,UACT,OAAO;AAAA,QACR;AAAA,QACD;AAAA,UACE,IAAI;AAAA,UACJ,MAAM;AAAA,UACN,OAAO;AAAA,UACP,OAAO,CAAE;AAAA,UACT,SAAS;AAAA,UACT,OAAO;AAAA,QACR;AAAA,QACD;AAAA,UACE,IAAI;AAAA,UACJ,MAAM;AAAA,UACN,OAAO;AAAA,UACP,OAAO,CAAE;AAAA,UACT,SAAS;AAAA,UACT,OAAO;AAAA,QACT;AAAA,MACD;AAAA,MACD,kBAAkB;AAAA,IACpB;AAAA,EACD;AAAA,EACD,SAAS;AAAA;AAAA,IAEP,MAAM,eAAe,YAAY;AAC/B,UAAI,KAAK,qBAAqB,YAAY;AACxC,aAAK,mBAAmB;AACxB;AAAA,MACF;AAEA,WAAK,mBAAmB;AAExB,YAAM,WAAW,KAAK,eAAe,KAAK,OAAK,EAAE,OAAO,UAAU;AAClE,UAAI,CAAC;AAAU;AAGf,UAAI,SAAS,MAAM,SAAS,KAAK,SAAS;AAAS;AAEnD,YAAM,KAAK,WAAW,QAAQ;AAAA,IAC/B;AAAA,IAED,MAAM,WAAW,UAAU;AACzB,eAAS,UAAU;AACnB,eAAS,QAAQ;AAEjB,UAAI;AACF,cAAM,MAAM,MAAMA,2BAAQ;AAAA,UACxB,KAAK;AAAA,UACL,QAAQ;AAAA,UACR,QAAQ;AAAA,YACN,iBAAkBC,cAAG,MAAC,eAAe,OAAO,KAAG;AAAA,YAC/C,gBAAgB;AAAA,UACjB;AAAA,UACD,MAAM;AAAA,YACJ,QAAQ,SAAS;AAAA,UACnB;AAAA,SACD;AAED,iBAAS,QAAQ,IAAI;AAAA,MACrB,SAAO,OAAO;AACdA,sBAAAA,MAAA,MAAA,SAAA,gCAAc,WAAW,KAAK;AAC9B,iBAAS,QAAQ,MAAM,WAAW;AAAA,MACpC,UAAU;AACR,iBAAS,UAAU;AAAA,MACrB;AAAA,IACD;AAAA;AAAA,IAGD,WAAW,MAAM,WAAW;AAC1BA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,qCAAqC,KAAK,EAAE,SAAS,SAAS;AAAA,OACpE;AAAA,IACH;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnIA,GAAG,WAAW,eAAe;"}